// ---------------------------------------------------------------------- 
// GENERATED FILE 
// All code in this file is generated by the SuperModels workbench 
// (version 5.0.0.1292). Any changes made to this file may lead to 
// incorrect behaviour and will be lost if the code is generated again. 
// Modify the model instead. 
// 
// Copyright : Sioux Technologies 
// Model     : Traffic.sms (Traffic) 
// Generator : C# state machine generator (Decomp1) 
// ---------------------------------------------------------------------- 

// ReSharper disable CheckNamespace
// ReSharper disable InconsistentNaming
// ReSharper disable ClassWithVirtualMembersNeverInherited.Global

#pragma warning disable CS8618

using HalFramework;
using Comm.Grpc.Common;
using Comm.Grpc;

namespace Traffic.Generated.HAL1;

public partial class HAL1Communication
{
    public List<ICommunicator> CommunicationElements { get; } = new();

    public DigitalOutput CarRed { get; set; }
    public DigitalOutput CarYellow { get; set; }
    public DigitalOutput CarGreen { get; set; }
    public DigitalOutput PedRed { get; set; }
    public DigitalOutput PedGreen { get; set; }

    public GrpcBusClient GrpcBusClient { get; set; }

    public Action? CustomBuilder { get; set; }

    public virtual void Build()
    {
        CustomBuilder ??= BuildInternal;
        CustomBuilder.Invoke();
    }

    private void BuildInternal()
    {
        CarRed = new DigitalOutput(GrpcBusClient, 17);
        CarYellow = new DigitalOutput(GrpcBusClient, 18);
        CarGreen = new DigitalOutput(GrpcBusClient, 19);
        PedRed = new DigitalOutput(GrpcBusClient, 20);
        PedGreen = new DigitalOutput(GrpcBusClient, 21);
    }

    public void PostCreationSetup()
    {
        CommunicationElements.Add(CarRed);
        CommunicationElements.Add(CarYellow);
        CommunicationElements.Add(CarGreen);
        CommunicationElements.Add(PedRed);
        CommunicationElements.Add(PedGreen);
    }

    public void Run() 
    {
        CommunicationElements.ForEach(communicationElement => communicationElement.Run());
    }
}
