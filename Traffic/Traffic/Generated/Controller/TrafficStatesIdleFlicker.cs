// ---------------------------------------------------------------------- 
// GENERATED FILE 
// All code in this file is generated by the SuperModels workbench 
// (version 5.0.0.1292). Any changes made to this file may lead to 
// incorrect behaviour and will be lost if the code is generated again. 
// Modify the model instead. 
// 
// Copyright : Sioux Technologies 
// Model     : Traffic.sms (Traffic) 
// Generator : C# state machine generator (Decomp1) 
// Source    : TrafficDomainModel.Controller.TrafficStates.IdleFlicker 
// ---------------------------------------------------------------------- 

// ReSharper disable IdentifierTypo
// ReSharper disable CheckNamespace
// ReSharper disable PartialTypeWithSinglePart
// ReSharper disable InconsistentNaming
// ReSharper disable RedundantUsingDirective
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ClassWithVirtualMembersNeverInherited.Global
// ReSharper disable UseObjectOrCollectionInitializer
// ReSharper disable once ClassNeverInstantiated.Global

using System.Collections.Generic;
using InterfaceServices.Model;
using StatemachineFramework.Statemachines;
using StatemachineFramework.Statemachines.Builder;
using ExtensionMethods;
using Traffic.Generated.Interfaces;
using HalFramework.Interfaces.Reference;
using HalFramework.Interfaces.Reference.Common;

namespace Traffic.Generated.Controller;

public class TrafficStatesIdleFlicker : Statemachine
{
    public TrafficStatesIdleFlicker(ControllerContext context, EventBuffer inBuffer)
    {
        Name = "States";

        // States
        var initial5 = new StateBuilder(StateId.state_initial5_2, StateBuilder.CreationType.Initial)
            .Name("Initial5")
            .Build();
        var idleOff = new StateBuilder(StateId.state_idleOff_3)
            .Name("IdleOff")
            .Build();
        var idleOn = new StateBuilder(StateId.state_idleOn_4)
            .Name("IdleOn")
            .OnEntry(context.__ENTRY_state_idleOn_4)
            .OnExit(context.__EXIT_state_idleOn_4)
            .Build();

        States = new List<StatemachineFramework.Statemachines.State>
        {
            initial5,
            idleOff,
            idleOn
        };

        // Transitions
        var t31 = new TransitionBuilder(TransitionId.transition_t31_0)
            .Name("t31")
            .From(StateId.state_idleOn_4)
            .To(StateId.state_idleOff_3)
            .Guard(context.__GUARD_transition_t31_0)
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Promise(() => context.CarYellow.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.CarYellow.Impl.Provider.PortName, NormallyClosedValveItf.Events.Close)))
            .Promise(() => context.PedGreen.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.PedGreen.Impl.Provider.PortName, NormallyClosedValveItf.Events.Close)))
            .Build();
        var t32 = new TransitionBuilder(TransitionId.transition_t32_1)
            .Name("t32")
            .From(StateId.state_idleOff_3)
            .To(StateId.state_idleOn_4)
            .Guard(context.__GUARD_transition_t32_1)
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Promise(() => context.CarYellow.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.CarYellow.Impl.Provider.PortName, NormallyClosedValveItf.Events.Open)))
            .Promise(() => context.PedGreen.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.PedGreen.Impl.Provider.PortName, NormallyClosedValveItf.Events.Open)))
            .Build();
        var t34 = new TransitionBuilder(TransitionId.transition_t34_2)
            .Name("t34")
            .From(StateId.state_initial5_2)
            .To(StateId.state_idleOn_4)
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Guard(_ => !inBuffer.ContainsIncoming("p", typeof(NormallyClosedValveItf.Events)))
            .Promise(() => context.CarYellow.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.CarYellow.Impl.Provider.PortName, NormallyClosedValveItf.Events.Open)))
            .Promise(() => context.PedGreen.Impl.Provider.EventBuffer.Promise(new InterfaceServices.Model.EventId(context.PedGreen.Impl.Provider.PortName, NormallyClosedValveItf.Events.Open)))
            .Build();

        Transitions = new List<StatemachineFramework.Statemachines.Transition>
        {
            t31,
            t32,
            t34
        };

        InitialState = initial5;
    }

    /// <inheritdoc />
    public override string Name { get; }

    /// <inheritdoc />
    public override IList<StatemachineFramework.Statemachines.State> States { get; }

    /// <inheritdoc />
    public override IList<StatemachineFramework.Statemachines.Transition> Transitions { get; }
}
